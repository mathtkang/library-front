{% extends "_base.html" %}

{% block title %}책 소개 페이지{% endblock %}

{% block script %}
<script>

</script>
{% endblock %}

{% block content %}
<h2>책 소개 페이지</h2>

<div>
    <div>
        <img class="" src="../static/img/{{ book_info.img_lick }}.jpg" alt="{{book_info.book_name}}" style="height:550px;width:430px;">
    </div>
    <div>
        <table class="book_info" style="width:85%; height:100%;margin-left:100px;">
            <tr>
                <th>책 이름</th>
                <td>{{book_info.book_name}}</td>
            </tr>
            <tr>
                <th>출판사</th>
                <td>{{book_info.publisher}}</td>
            </tr>
            <tr>
                <th>저자</th>
                <td>{{book_info.author}}</td>
            </tr>
            <tr>
                <th>출간일</th>
                <td>{{book_info.publication_date}}</td>
            </tr>
            <tr>
                <th>페이지 수</th>
                <td>{{book_info.pages}} 쪽</td>
            </tr>
            <tr>
                <th>ISBN 코드</th>
                <td>{{book_info.isbn}}</td>
            </tr>
            <tr>
                <th>평점</th>
                <td>
                    {% for _ in range(book_info.star) %}
                        <i class="bi bi-star-fill" style="color: red;">*</i>
                    {% endfor %}
                    {% for _ in range(5 - book_info.star) %}
                        <i class="bi bi-star" style="color: gray;">*</i>
                    {% endfor %}
                </td>
            </tr>
            <tr>
                <th>총 대여 횟수</th>
                <td>{{book_info.rental_val}} 회</td>
            </tr>
            <tr>
                <th>재고</th>
                {% if book_info.remaining == 0 %}
                    <td style="color: red;">재고 없음</td>
                {% else %}
                    <td>{{book_info.remaining}} 권 남음</td>
                {% endif %}
                </td>
            </tr>
            <tr>
                <button>대여하기</button>
            </tr>
        </table>
    </div>
</div>
<div>
    <h2>책 소개</h2>
    <div>
        <p>{{book_info.description}}</p>
    </div>
</div>

<!-- 지금까지 작성된 댓글 보여주기 -->
<div class="container">
    <h2 style="font-size: 30px;">댓글</h2>
    <hr>
    {% for review in review_info %}
    <div class="user_info">
        <span>{{ review.user_name }}</span>
        <span class="bar">|</span>
        <span>{{ review.user_email_code }}</span>
        <span class="bar">|</span>
        <span>{{ review.write_time }}</span>
        <span class="bar">|</span>
        {% for _ in range(book_info.star) %}
            <i class="bi bi-star-fill" style="color: yellow;">*</i>
            <!-- 엄지척 모양으로 바꾸자 -->
        {% endfor %}
        {% for _ in range(5 - book_info.star) %}
            <i class="bi bi-star" style="color: gray;">*</i>
        {% endfor %}
    </div>

    <div class="user_only">
        {% if session['user_email'] == review.user_email %}
        <button>수정하기</button>
        <button>삭제하기</button>
        {% endif %}
    </div>

    <div class="book_review">
        <p>{{ review.content }}</p>
    </div>
    {% endfor %}
</div>

<!-- 로그인된 유저만 댓글 작성하기 -->
{% if session['user_id'] %}
<h3>댓글 작성하기</h3>
<!-- api 이름! -->
<form action="{{ url_for('main.function_name', book_id=book_info.id) }}" method="post">
    <div>
        <textarea placeholder="댓글을 작성하세요"
        name="review"></textarea>
    </div>
    <select name="star">
        <!-- 별점을 어떻게 할지 구상해보자! -->
        <option value="1">1점</option>
        <option value="2">2점</option>
        <option value="3">3점</option>
        <option value="4">4점</option>
        <option value="5">5점</option>
    </select>
    <input class="btn btn-primary" type="submit" value="확인">
</form>
{% endif %}


{% endblock %}